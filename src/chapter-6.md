# おわりに。ビジネス・アプリケーション・プログラマーにとっての、ロボットのソフトウェア開発

ROSプログラミングについて長々と書いておきながら申し訳ないのですが、実は、私の本業はビジネス・アプリケーションのプログラマーです。普段は関数型言語で、Webアプリケーションを作っています。まぁ、私がロボットの素人であることは、「3D点群を統合する」の章での迷走っぷりから皆様も気がついていたでしょうけど。

#### ロボットのソフトウェア開発は簡単

本稿で私の恥ずかしい迷走劇をご覧頂いたのは、専門家「以外」がROSプログラミングに必要な情報を集める方法をご紹介したかったためです。チュートリアルをやって、リファレンスを見て、テスト・コードを読んで、実際に動かしてみれば、その道の専門家でなくともライブラリは使えます（もしこれで足りなければ、他人が作成したコードを読む）。

で、このような面倒な手順を紹介すべきだと考えた理由は、ロボット工学の専門家「以外」もロボットのソフトウェアを開発できる時代になったと考えるためです。実際に本稿で、点群の素人の私がIterative Closest PointとLM法を活用するロボットのソフトウェアを作成できたわけですしね（私がやったのはPCLの呼び出しだけですけど、ソフトウェアを外から見るだけならバレないはず）。本稿の途中で紹介した`gmapping`と`navigation`を使えば、「自律移動する○○」という、最近良く見る商品のソフトウェアをすぐに開発できます。

ROSの豊富なパッケージを使えば、プログラマーなら誰でもロボットのソフトウェアを開発できるんです。ロボットのソフトウェア開発は、簡単なんですよ。

#### ロボットのソフトウェア開発は難しい

でも、ビジネス・アプリケーションでRDBMSでトランザクションでエラーをはじいたクリーン・データでビジネス・ロジックを書くことに慣れた私だと、誤差を解消する手段が分からなくて途方に暮れることも多いです。そもそも、誤差なんて概念は、私の頭のどこにも無いわけですし。

本稿で使用したPCLや途中でご紹介した`gmapping`や`navigation`のような、誤差を解消してくれるパッケージを使える分野なら、問題はありません。でも、パッケージが無かったり、パッケージの限界を超えるような場合は、自分でどうにかしなければなりません。今回のように簡単な計算で誤差をごまかせるのは稀で、専門知識が必要になるケースがほとんどでしょう。パッケージを使うのは簡単ですけど、パッケージを作るのはやっぱり難しい。

その意味では、ロボットのソフトウェア開発は難しいとも言えます。特に、私のような誤差に馴染みがない、伝統的なビジネス・アプリケーションのプログラマーにとっては。

#### ロボットのSIなんて、どうでしょうか？

[Wikipediaによれば](https://ja.wikipedia.org/wiki/%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%82%A4%E3%83%B3%E3%83%86%E3%82%B0%E3%83%AC%E3%83%BC%E3%82%BF%E3%83%BC)、System Integrationは「複数のベンダから汎用のパッケージ・ソフトウェアやハードウェアなどの完成品を購入して、1つのシステムとして矛盾なく、効果が出るように組み立て、統合する」ことなんだそうです[^14]。ROSを使ったロボットのソフトウェア開発なら、まさにこのSIができると思うんですよ。お客様の業務と、パッケージの特徴と限界の知識を活用し、効果が出る統合を実現すればよいわけですから。

ロボットのSIでも、ビジネス・アプリケーション開発で培ったお客様の業務に関する知識、これまで多種多様なソフトウェアやハードウェアを評価してきた選別眼、システム全体を運用するノウハウを、大きく活用できると私は考えています。

[^14]: ShitaukeをIntegrationしてソフトウェアを一から構築する日本固有のSIは、今は忘れてください。

#### 皆様なら、パッケージの作成も

本稿で作成したプログラム、とくに3D点群を統合する部分は、残念ながら実用性は低いです。遅いですし、点群の統合に失敗することもあります。

遅いという問題の特効薬は、新しいアルゴリズムです。私の場合、これは専門家が研究して論文（とコード）にまとめてくれるのを待つしかありません。ただ、今回使用した範囲でのPCLの動きを見ると、CPUが一つしか使われていませんし、GPUプログラミングもなされていないようです。並列化の余地は大きいでしょう。プログラミング・テクニックで実行効率を向上させられる範囲も、それなりにあるはずです。

精度の問題でも、やっぱり新しいアルゴリズムが欲しい。でも、これも私のレベルだと専門家待ち。ただ、TurtleBotはZ軸での回転しかできなくて、回転の軸が少なければ解空間は小さくなるので、TurtleBot用に少し特化することで精度を向上できるかもしれません。計算量が減りますから、パフォーマンスが上がる可能性もあるでしょう。

あと、私がROSのメッセージを使うときに感じているのは、大昔のO/Rマッピング・ツールみたいだなぁということです。ROSのメッセージは、専用言語でデータ構造を定義してコードを生成させていた古い時代の、プログラミング言語の中でエンティティ・オブジェクトを定義可能になる前のO/Rマッピング・ツールと同じやり方なんですよ。Ruby on Railsのような、メッセージ（Railsではデータベースのスキーマ）をマッピングしたクラスにメソッドを追加できる方式もイケるかも。メッセージを明示的に投げるのも格好悪い。Webアプリケーションで使われているリアクティブ・プログラミングなら、全自動で変更が伝播するのにね。

私のようなビジネス・アプリケーション・プログラマー、ロボット工学の素人でも、嬉しいことにROSに貢献することができるかもしれません。こんなダラダラした文章をここまで読んだ根性がある皆様なら、余裕ですよ。もし皆様がロボット工学をほんの少しやっているなら、パッケージ作りまくりですよ。
